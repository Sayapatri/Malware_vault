import os
from cryptography.fernet import Fernet, InvalidToken

# read the encryption key from the key file
with open("key.key", "rb") as key_file:
    key = key_file.read()

# list all files in the directory
path = "."
files = os.listdir(path)

# decrypt the data in each file using the key
fernet = Fernet(key)
for file in files:
    if os.path.isfile(file) and file not in ["dec.py", "key.key", "mal.py"]:
        try:
            with open(file, "rb") as encrypted_file:
                encrypted_data = encrypted_file.read()

            decrypted_data = fernet.decrypt(encrypted_data)
            with open(file, "wb") as decrypted_file:
                decrypted_file.write(decrypted_data)
        except InvalidToken as e:
            print(f"Failed to decrypt {file}: {e}")
